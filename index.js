import t from"alfy";import e from"deepl-node";function r(t,e,r,n){return new(r||(r=Promise))((function(s,i){function o(t){try{l(n.next(t))}catch(t){i(t)}}function a(t){try{l(n.throw(t))}catch(t){i(t)}}function l(t){var e;t.done?s(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(o,a)}l((n=n.apply(t,e||[])).next())}))}"function"==typeof SuppressedError&&SuppressedError;const n=e=>t.error(e),s=["en-US","zh"];const i=new class{constructor(t,e){this.translator=null,this.preferred=s,this.processTranslate=(t,e,s)=>r(this,void 0,void 0,(function*(){const r=null!=e?e:null,i=null!=s?s:this.preferred[0],o=yield this.translateText(t,r,i);if(!o)return void n("No result");const{text:a,detectedSourceLang:l}=o;if(l===i){const e=this.preferred[1];return e?this.processTranslate(t,r,e):Object.assign(Object.assign({},o),{targetLang:e})}return Object.assign(Object.assign({},o),{targetLang:i})})),this.instanceInit(t),this.preferredInit(null==e?void 0:e.preferred)}instanceInit(t){t?this.translator=new e.Translator(t):n("Missing auth key")}preferredInit(t){this.preferred=t?t.trim().split(","):s}translateText(t,e,r){var n;return null===(n=this.translator)||void 0===n?void 0:n.translateText(t,null!=e?e:null,r)}}(process.env.auth_key,{preferred:process.env.preferred});(e=>{const{input:r}=t;e(r)})((e=>r(void 0,void 0,void 0,(function*(){const r=yield i.processTranslate(e,null);if(!r)return;const{text:n,detectedSourceLang:s,targetLang:o}=r;var a,l;a=[{title:n,variables:{url:`/${"en-US"===o?"en":o}/${e}`},arg:n}],t.output(a,l)}))));
